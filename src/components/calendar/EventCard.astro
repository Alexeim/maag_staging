---
import { MapPin } from "lucide-astro";

interface Props {
  tag: string;
  date: string;
  title: string;
  location: string;
  url?: string;
  image?: ImageMetadata;
  imageUrl?: string;
  class?: string;
  textSize?: "med" | "lg";
}

const {
  tag,
  date,
  title,
  location,
  url = "#",
  image,
  imageUrl,
  class: className,
  textSize = "lg",
} = Astro.props;

const resolvedImageSrc = (() => {
  if (typeof imageUrl === "string" && imageUrl.trim().length > 0) {
    return imageUrl;
  }
  if (image && "src" in image) {
    return image.src;
  }
  return "";
})();
---

<a
  href={url}
  class:list={[
    "group relative text-white overflow-hidden p-8 flex flex-col justify-end h-96 border border-white/10 shadow-[0_20px_60px_rgba(0,0,0,0.28)] transition-transform duration-300 hover:-translate-y-1",
    className,
  ]}
  style={`background-image: url(${resolvedImageSrc}); background-size: cover; background-position: center;`}
>
  <div
    class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/55 to-black/25"
  >
  </div>
  <div
    class="absolute inset-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100 bg-gradient-to-r from-white/10 to-transparent"
  >
  </div>
  <div
    class="relative z-10 max-w-2xl bg-black/45 backdrop-blur-sm p-4 border border-white/20"
  >
    <span
      class="text-xs uppercase tracking-[0.25em] font-medium text-error font-inter"
      >{tag}</span
    >
    <p class="font-inter text-base mt-1 tracking-[0.02em] font-light uppercase">
      {date}
    </p>
    <h3
      class={`font-oswald ${textSize === "lg" ? "text-4xl" : "text-2xl"} mt-2 leading-tight text-balance tracking-[0.015em] font-medium`}
    >
      {title}
    </h3>
    <div
      class="flex items-center mt-4 text-base font-inter tracking-[0.02em] font-light text-white/95"
    >
      <MapPin class="w-4 h-4 shrink-0" />
      <span class="ml-2">{location}</span>
    </div>
  </div>
</a>
